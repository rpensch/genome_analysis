if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
browseVignettes("DESeq2")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount")
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
library("DESeq2")
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797974'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797969'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797970'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
sampleNames <- c('ERR1797972', 'ERR1797973', 'ERR1797974', 'ERR1797969', 'ERR1797970', 'ERR1797971')
condition <- c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum')
colData <- data.frame(row.names=colnames(countData), condition=factor(condition, levels=c('BH','Serum')))
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
result <- results(dds, contrast=c('condition','Serum','BH'))
result <- result[complete.cases(result),]  #remove any rows with NA
summary(result)
n = 20
resOrdered <- result[order(result$padj),]
topResults <- rbind( resOrdered[ resOrdered[,'log2FoldChange'] > 0, ][1:n,],
resOrdered[ resOrdered[,'log2FoldChange'] < 0, ][n:1,] )
topResults[c(1:5,(2*n-4):(2*n)), c('baseMean','log2FoldChange','padj')]
plotMA(result)
View(colData)
condition
condition <- factor(c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum'))
condition
colData
dds
View(dds)
cds <- estimateSizeFactors(dds)
cds
cds <- estimateSizeFactors(countData)
summary(result)
res <- results(dds)
res
result <- results(dds, contrast=c('condition','Serum','BH'))
result <- result[complete.cases(result),]  #remove any rows with NA
result
result <- results(dds, contrast=c('condition','Serum','BH'))
result <- result[complete.cases(result),]  #remove any rows with NA
summary(result)
resOrdered <- result[order(result$padj),]
topResults <- rbind( resOrdered[ resOrdered[,'log2FoldChange'] > 0, ][1:n,],
resOrdered[ resOrdered[,'log2FoldChange'] < 0, ][n:1,] )
View(topResults)
topResults
topResults
topResults
