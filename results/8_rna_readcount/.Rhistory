if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
browseVignettes("DESeq2")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/")
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
library("DESeq2")
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797974'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797969'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797970'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
sampleNames <- c('ERR1797972', 'ERR1797973', 'ERR1797974', 'ERR1797969', 'ERR1797970', 'ERR1797971')
condition <- c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum')
colData <- data.frame(row.names=colnames(countData), condition=factor(condition, levels=c('BH','Serum')))
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
result <- results(dds, contrast=c('condition','Serum','BH'))
result <- result[complete.cases(result),]  #remove any rows with NA
summary(result)
n = 20
resOrdered <- result[order(result$padj),]
topResults <- rbind( resOrdered[ resOrdered[,'log2FoldChange'] > 0, ][1:n,],
resOrdered[ resOrdered[,'log2FoldChange'] < 0, ][n:1,] )
topResults[c(1:5,(2*n-4):(2*n)), c('baseMean','log2FoldChange','padj')]
plotMA(result)
n = 20
resOrdered <- result[order(result$padj),]
topResults <- rbind( resOrdered[ resOrdered[,'log2FoldChange'] > 0, ][1:n,],
resOrdered[ resOrdered[,'log2FoldChange'] < 0, ][n:1,] )
topResults[c(1:5,(2*n-4):(2*n))]
topResults
topResults[c(1:5,(2*n-4):(2*n)), c('baseMean','log2FoldChange','lfcSEL', 'stat', 'pvalue', 'padj')]
topResults
res
res <- results(dds)
res
result <- results(dds, contrast=c('condition','Serum','BH'))
significant_result <- result[ which(result$padj < 0.1 ), ]
head(significant_result[order(significant_result$log2FoldChange),])
tail(significant_result[order(significant_result$log2FoldChange),])
result <- results(dds, contrast=c('condition','Serum','BH'))
significant_result <- result[ which(result$padj < 0.1 ), ]
head(significant_result[order(significant_result$log2FoldChange),], n = 10)
tail(significant_result[order(significant_result$log2FoldChange),], n = 10)
result <- results(dds, contrast=c('condition','Serum','BH'))
significant_result <- result[ which(result$padj < 0.1 ), ]
head(significant_result[order(significant_result$log2FoldChange),], n = 10)
tail(significant_result[order(significant_result$log2FoldChange),], n = 10)
#plotMA(result)
plotMA(result, ylim = c(-1, 1) )
plotDispEsts( dds, ylim = c(1e-6, 1e1) )
hist( result$pvalue, breaks=20, col="grey" )
rlog_dds <- rlog(dds)
plot( assay(rld)[, 1:2], col="#00000020", pch=20, cex=0.3 )
rlog_dds <- rlog(dds)
plot( assay(rlog_dds)[, 1:2], col="#00000020", pch=20, cex=0.3 )
rlog_dds <- rlog(dds)
par( mfrow = c( 1, 2 ) )
plot(assay(rlog_dds)[, 1:2], col="#00000020", pch=20, cex=0.3 )
install.packages("gplots")
library(gplots)
library(gplots)
rlog_dds <- rlog(dds)
sampleDists <- dist(t( assay(rlog_dds)))
sampleDistMatrix <- as.matrix( sampleDists )rownames(sampleDistMatrix) <- paste( rlog_dds$condition, sep="-" )colnames(sampleDistMatrix) <- NULLlibrary( "gplots" )library( "RColorBrewer" )colours = colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)heatmap.2( sampleDistMatrix, trace="none", col=colours)
install.packages("RColorBrewer")
install.packages("RColorBrewer")
library( "RColorBrewer" )
rlog_dds <- rlog(dds)
sampleDists <- dist(t( assay(rlog_dds)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste( rlog_dds$condition, sep="-" )
colnames(sampleDistMatrix) <- NULLlibrary( "gplots" )library( "RColorBrewer" )colours = colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)heatmap.2( sampleDistMatrix, trace="none", col=colours)
rlog_dds <- rlog(dds)
sampleDists <- dist(t( assay(rlog_dds)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste( rlog_dds$condition, sep="-" )
colnames(sampleDistMatrix) <- NULL
colours = colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
heatmap.2( sampleDistMatrix, trace="none", col=colours)
colData
rlog_dds <- rlog(dds)
sampleDists <- dist(t( assay(rlog_dds)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste( rlog_dds$condition, sep="-" )
#colnames(sampleDistMatrix) <- NULL
colours = colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
heatmap.2(sampleDistMatrix, trace="none", col=colours)
rlog_dds <- rlog(dds)
sampleDists <- dist(t( assay(rlog_dds)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste( rlog_dds$condition, sep="-" )
#colnames(sampleDistMatrix) <- NULL
colours = colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
heatmap.2(sampleDistMatrix, trace="none", col=colours)
rlog_dds <- rlog(dds)
plotOCA(rlog_dds)
plotPCA(rlog_dds)
plotPCA(rlog_dds)
hist( result$pvalue, breaks=20, col="grey" )
hist( result$pvalue, breaks=20, col="grey" )
rlog_dds <- rlog(dds)
plotPCA(rlog_dds)
rlog_dds <- rlog(dds)
plotPCA(rlog_dds,ylim = c(-10, 10))
rlog_dds <- rlog(dds)
plotPCA(rlog_dds)
View(rlog_dds)
rlog_dds <- rlog(dds)
plotPCA(dds)
rlog_dds <- rlog(dds)
plotPCA(rlog_dds)
library( "genefilter" )
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 35)
heatmap.2(assay(rld)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")) )(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 35)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")) )(255))
rlog_dds <- rlog(dds)
plotPCA(rlog_dds)
title("PCA")
rlog_dds <- rlog(dds)
plotPCA(rlog_dds)
hist( result$pvalue, breaks=20, col="grey" )
title("Histogram")
hist( result$pvalue, breaks=20, col="grey" )
hist( result$pvalue, breaks=20, col="grey", title = "JJ" )
hist( result$pvalue, breaks=20, col="grey")
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(x, file, append = FALSE, sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(x, "diff_expr_genes.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(y, "diff_expr_genes.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
y
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(x, "diff_expr_genes.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(y, "diff_expr_genes.txt", append = TRUE, sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
y
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(y, "diff_expr_genes_up.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
y
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(x, "diff_expr_genes_down.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
library("DESeq2")
install.packages("gplots")
library(gplots)
install.packages("RColorBrewer")
library( "RColorBrewer" )
library( "genefilter" )
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797974'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797969'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797970'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
sampleNames <- c('ERR1797972', 'ERR1797973', 'ERR1797974', 'ERR1797969', 'ERR1797970', 'ERR1797971')
condition <- c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum')
colData <- data.frame(row.names=colnames(countData), condition=factor(condition, levels=c('BH','Serum')))
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
summary(result)
install.packages("RColorBrewer")
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 50)
rlog_dds <- rlog(dds)
plotPCA(rlog_dds)
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 50)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 20)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 10)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 50)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 100)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 200)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 300)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 20)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 15)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 40)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 50)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 30)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 40)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 20)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 30)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
topVarGenes <- head(order(rowVars(assay(rlog_dds)), decreasing=TRUE), 50)
heatmap.2(assay(rlog_dds)[ topVarGenes,], scale="row",trace="none", dendrogram="column",col = colorRampPalette(rev(brewer.pal(9, "RdBu")))(255))
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 20)
result <- results(dds, contrast=c('condition','Serum','BH'))
significant_result <- result[ which(result$padj < 0.1 ), ]
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 10)
write.table(x, "diff_expr_genes_down.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(y, "diff_expr_genes_up.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
y
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(x, "diff_expr_genes_down.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(y, "diff_expr_genes_up.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
y
plotMA(result, ylim = c(-1, 1) )
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(x, "diff_expr_genes_down.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797974'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797969'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797970'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
sampleNames <- c('ERR1797972', 'ERR1797973', 'ERR1797974', 'ERR1797969', 'ERR1797970', 'ERR1797971')
condition <- c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum')
colData <- data.frame(row.names=colnames(countData), condition=factor(condition, levels=c('BH','Serum')))
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
summary(result)
result <- results(dds, contrast=c('condition','Serum','BH'))
significant_result <- result[ which(result$padj < 0.1 ), ]
summary(result)
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(x, "diff_expr_genes_down.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(y, "diff_expr_genes_up.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
y
plotMA(result, ylim = c(-1, 1) )
plotDispEsts(dds, ylim = c(1e-6, 1e1))
hist( result$pvalue, breaks=20, col="grey")
setwd('C:/Users/Raphaela/Documents/UU/GA/genome_analysis/results/8_rna_readcount/')
setwd('C:/Users/Raphaela/Documents/UU/GA/genome_analysis/results/8_rna_readcount/')
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797974'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797969'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797970'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
total_reads_per_file <- colSums(countData)
not_aligned_per_file <- countData["__not_aligned",]
mapped_reads_per_file <- total_reads_per_file - not_aligned_per_file
total_reads <- sum(total_reads_per_file)
total_not_aligned <- sum(not_aligned_per_file)
total_mapped_reads <- sum(mapped_reads_per_file)
perc_mapped_reads <- total_mapped_reads * 100 / total_reads
perc_mapped_reads
n<-dim(countData)[1]
reads_on_features<-countData[1:(n-5),]
total_reads_on_features <- sum(colSums(reads_on_features))
perc_reads_on_features <- total_reads_on_features * 100 / total_reads
perc_reads_on_features
total_no_feature <- sum(countData["__no_feature",])
total_no_feature
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
plotCounts(dds)
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/UU/GA/genome_analysis/results/8_rna_readcount/')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
library("DESeq2")
install.packages("gplots")
library(gplots)
install.packages("RColorBrewer")
library( "RColorBrewer" )
library( "genefilter" )
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
install.packages("RColorBrewer")
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
knitr::opts_knit$set(root.dir = 'C:/Users/Raphaela/Documents/UU/GA/genome_analysis/results/8_rna_readcount/')
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797974'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797969'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797970'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
sampleNames <- c('ERR1797972', 'ERR1797973', 'ERR1797974', 'ERR1797969', 'ERR1797970', 'ERR1797971')
condition <- c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum')
colData <- data.frame(row.names=colnames(countData), condition=factor(condition, levels=c('BH','Serum')))
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
result <- results(dds, contrast=c('condition','Serum','BH'))
significant_result <- result[ which(result$padj < 0.1 ), ]
summary(result)
x <- head(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(x, "diff_expr_genes_down.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
x
y <- tail(significant_result[order(significant_result$log2FoldChange),], n = 20)
write.table(y, "diff_expr_genes_up.txt", sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
y
plotCounts(dds)
plotCounts(dds, gene=result, intgroup='condition')
countData
View(countData)
