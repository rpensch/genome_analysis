if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
browseVignettes("DESeq2")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
setwd("C:\Users\Raphaela\UU\GA\genome_analysis\results\htseq_readcount")
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/htseq_readcount")
Set the working directory
```{r include=FALSE}
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/htseq_readcount")
```
Install DESeq2
```{r include=FALSE}
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
library("DESeq2")
bh1 <- read.delim(htseq_readcount_BH_paired_ERR1797972.txt, header = TRUE, sep = "\t")
bh1 <- read.delim("htseq_readcount_BH_paired_ERR1797972.txt", header = TRUE, sep = "\t")
View(bh1)
bh1 <- read.delim("htseq_readcount_BH_paired_ERR1797972.txt", header = FALSE, sep = "\t")
View(bh1)
bh1 <- read.delim("htseq_readcount_BH_paired_ERR1797972.txt", header = FALSE, sep = "\t")
bh2 <- read.delim("htseq_readcount_BH_paired_ERR1797973.txt", header = FALSE, sep = "\t")
bh3 <- read.delim("htseq_readcount_BH_paired_ERR1797974.txt", header = FALSE, sep = "\t")
serum1 <- read.delim("htseq_readcount_Serum_paired_ERR1797969.txt", header = FALSE, sep = "\t")
serum2 <- read.delim("htseq_readcount_Serum_paired_ERR1797970.txt", header = FALSE, sep = "\t")
serum3 <- read.delim("htseq_readcount_Serum_paired_ERR1797971.txt", header = FALSE, sep = "\t")
View(serum1)
print(bh1[1])
sampleNames <- c('bh1', 'bh2', 'bh3', 'serum1', 'serum2', 'serum3')
sampleFiles <- data.frame(bh1, bh2[2], bh3[2], row.names = bh1[1], column.names = sampleNames)
sampleNames <- c('bh1', 'bh2', 'bh3', 'serum1', 'serum2', 'serum3')
sampleFiles <- data.frame(bh1, bh2[2], bh3[2], row.names = bh1[1])
sampleNames <- c('bh1', 'bh2', 'bh3', 'serum1', 'serum2', 'serum3')
sampleFiles <- data.frame(bh1, bh2[2], bh3[2])
View(sampleFiles)
sampleNames <- c('bh1', 'bh2', 'bh3', 'serum1', 'serum2', 'serum3')
sampleFiles <- data.frame(bh1[2], bh2[2], bh3[2])
sampleNames <- c('bh1', 'bh2', 'bh3', 'serum1', 'serum2', 'serum3')
sampleFiles <- data.frame(bh1[2], bh2[2], bh3[2], row.names = bh1[1])
sampleNames <- c('bh1', 'bh2', 'bh3', 'serum1', 'serum2', 'serum3')
sampleFiles <- data.frame(bh1[1]bh1[2], bh2[2], bh3[2], row.names = bh1[1] )
sampleFiles <- data.frame(bh1[1] bh1[2], bh2[2], bh3[2], row.names = bh1[1] )
sampleFiles <- data.frame(bh1[1], bh1[2], bh2[2], bh3[2], row.names = bh1[1] )
sampleFiles <- data.frame(
"bh1" = bh1[2],
"bh2" = bh2[2],
"bh3" = bh3[2],
row.names = bh2[1]
)
sampleFiles <- data.frame(
"bh1" = bh1[2],
"bh2" = bh2[2],
"bh3" = bh3[2]
)
sampleNames <- c('ERR1797972', 'ERR1797973', 'ERR1797974', 'ERR1797969', 'ERR1797970', 'ERR1797971')
conditions <- c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum')
sampleFiles <- data.frame(
"ERR1797972" = bh1[2],
"ERR1797973" = bh2[2],
"ERR1797974" = bh3[2],
"ERR1797969" = serum1[2],
"ERR1797970" = serum2[2],
"ERR1797971" = serum3[2]
)
View(bh1)
sampleFiles
names(sampleFiles) = sampleNames
row.names(sampleFiles) = bh1[1]
len(bh1[1])
length(bh1[1])
bh1[1]
width(bh1[1])
length(bh1[2])
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1)
row.names(bh1)
row.names = 1
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = 'ERR1797972' )
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1)
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1)
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1)
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1)
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1)
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = 'ERR1797972')
View(bh2)
View(bh3)
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = 'gene', 'ERR1797972' )
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972') )
View(bh1)
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = 'ERR1797972')
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('ERR1797972')
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('ERR1797972'))
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('ERR1797972')
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('ERR1797972'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('ERR1797972'));
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('ERR1797972');
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('ERR1797972'))
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
View(serum1)
setwd("C:/Users/Raphaela/UU/GA/genome_analysis/results/htseq_readcount")
install.packages("BiocManager")
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
View(bh1)
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
View(serum3)
View(serum2)
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- as.data.frame(bh1)
View(countData)
countData <- as.data.frame(bh1, bh2, bh3)
countData <- data.frame(bh1, bh2, bh3)
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
bh1 <- read.table("htseq_readcount_BH_paired_ERR1797972.txt", row.names = 1, col.names = c('gene', 'ERR1797972'))
bh2 <- read.table("htseq_readcount_BH_paired_ERR1797973.txt", row.names = 1, col.names = c('gene', 'ERR1797973'))
bh3 <- read.table("htseq_readcount_BH_paired_ERR1797974.txt", row.names = 1, col.names = c('gene', 'ERR1797974'))
serum1 <- read.table("htseq_readcount_Serum_paired_ERR1797969.txt", row.names = 1, col.names = c('gene', 'ERR1797969'))
serum2 <- read.table("htseq_readcount_Serum_paired_ERR1797970.txt", row.names = 1, col.names = c('gene', 'ERR1797970'))
serum3 <- read.table("htseq_readcount_Serum_paired_ERR1797971.txt", row.names = 1, col.names = c('gene', 'ERR1797971'))
countData <- data.frame(bh1, bh2, bh3, serum1, serum2, serum3)
sampleNames <- c('ERR1797972', 'ERR1797973', 'ERR1797974', 'ERR1797969', 'ERR1797970', 'ERR1797971')
condition <- c('BH', 'BH', 'BH', 'Serum', 'Serum', 'Serum')
colData <- data.frame(row.names=colnames(countData), condition=factor(condition, levels=c('BH','Serum')))
View(colData)
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
View(dataset)
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
result <- results(dds, contrast=c('condition','Infected','Control'))
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
result <- results(dds, contrast=c('condition','Serum','BH'))
result <- result[complete.cases(result),]  #remove any rows with NA
head(result)
summary(result)
n = 20
resOrdered <- result[order(result$padj),]
topResults <- rbind( resOrdered[ resOrdered[,'log2FoldChange'] > 0, ][1:n,],
resOrdered[ resOrdered[,'log2FoldChange'] < 0, ][n:1,] )
topResults[c(1:5,(2*n-4):(2*n)), c('baseMean','log2FoldChange','padj')]
plotMA(result, main='DESeq2: Growth in BH vs Serum', ylim=c(-2,2))
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
result <- results(dds, contrast=c('condition','Serum','BH'))
result <- result[complete.cases(result),]  #remove any rows with NA
dataset <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~condition)
dds <- DESeq(dataset)
result <- results(dds, contrast=c('condition','Serum','BH'))
result <- result[complete.cases(result),]  #remove any rows with NA
summary(result)
plotMA(result)
